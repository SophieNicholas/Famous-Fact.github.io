<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />
    <title>Tester</title>
    <link rel="stylesheet" href="css/skeleton.css">
    <style>
        .three {
            text-align: center;
            border-style: solid;
            border-color: black;
            border-width: 1px;
            border-top: none;
            height: 220px;
            padding-top:10px;
            padding-bottom: 10px;
        }

        .three.columns {
            width: 24%;
        }

        .columns {
            margin-left: 1%;
        }

        .container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            box-sizing: border-box;
        }
    </style>
</head>
<!-- In order to align 4 pics on the screen I had to make the css changes above -->
<div class="container">
    <div class="row">
        <div class="three columns gif1"></div>
        <div class="three columns gif2"></div>
        <div class="three columns gif3"></div>
        <div class="three columns gif4"></div>
    </div>
</div>
<div id="gifs-appear-here">
</div>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>

    var api = "jPos9RSs2YFAD8HQVQCBt782M5HUNlT6";
    var search = "star wars"
    var gifLimit = 350
    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + search + "&api_key=jPos9RSs2YFAD8HQVQCBt782M5HUNlT6&limit=" + gifLimit;
    console.log(queryURL)
    var shuffleNumber = 0;
    var gifClasses = [".gif1", ".gif2", ".gif3", ".gif4"];


    //SHUFFLE FUNCTION
    function shuffle(array) {
        var currentIndex = array.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;

            // And swap it with the current element.
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }

        return array;
    }
    //end of function


    //AJAX call
    $.ajax({
        url: queryURL,
        method: "GET"
    }).then(function (response) {
        console.log(response);
        var results = response.data
        console.log(results)
        var i2 = 0

        //creates a random number array the length of the limit to randomize the gif output
        var shuffleNumber = [];
        for (var n = 0; n < gifLimit; n++) {
            shuffleNumber.push(n);
        }
        shuffle(shuffleNumber);
        console.log(shuffleNumber);

        //runs loop here
        for (var i = 0; i2 < 4; i++) {

            // if we can't find 4 images that meet the criteria loop ends
            if (i > gifLimit) {
                i2 = 4
            }
            // looks for all gifs that are not rated r
            else if (results[shuffleNumber[i]].rating !== "r" && results[shuffleNumber[i]].rating !== "pg-13") {

                // looks for gifs that are 200px in height and less then 351px in width
                if (results[shuffleNumber[i]].images.fixed_height.width < 281) {
                    var gifDiv = $("<div>").css("float", "none");
                    var gifOutput = $("<img>");
                    gifOutput.attr({ "src": results[shuffleNumber[i]].images.fixed_height.url, "alt": results[shuffleNumber[i]].title });
                    gifDiv.append(gifOutput);
                    var gifNumber = gifClasses[i2];
                    $(gifNumber).append(gifDiv);
                    i2++
                }
            }
        }
    });


    console.log("hello")





</script>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
</body>

</html>